# Совершение платежей

В SDK реализованы как отдельные точки входа для каждого сценария оплаты, так и общая платежная форма, объединяющая в
себе доступные способы оплат для Вашего терминала.

> Для прохождения тест-кейсов и совершения тестовых платежей
> воспользуйтесь [тестовыми картами](https://www.tinkoff.ru/kassa/dev/payments/index.html#tag/Testovye-karty)

### Оплата с помощью платежной формы

Платежная форма — это форма для оплаты заказа в мобильном приложении, которая объединяет доступные способы оплаты:

- Оплата с помощью банковских карт
    - Оплата новой или существующей картой
    - Управление списком карт для оплаты
- Оплата с помощью T-Pay
- Оплата с помощью СБП
- Оплата с помощью Mir Pay

> По умолчанию, на платежной форме подключена оплата с помощью банковских карт и T-Pay.
> Другие способы оплаты можно
> подключить [по инструкции](https://opensource.tbank.ru/mobile-tech/asdk-android/-/blob/master/Docs/PersonalAccountSettings.md)
> через личный кабинет.
> Варианты визуального представления платежной формы в зависимости от доступных способов оплаты:

### 1. Инициализация SDK

Для того чтобы платежная форма стала обрабатывать платежи, следуйте данным шагам:
Создание экземпляра класса для связи с API. Ниже представлено как это сделать:

```C#
var terminalKey = "#############";
var password = "##################";
var publicKey = "###############################";

var acquiringSdk = new AcquiringSdk(terminalKey, password, publicKey)
{
    IsDeveloperMode = false
};
```

### 2. Формирование платежа

```C#
var paymentId = await acquiringSdk.Init(1000, Guid.NewGuid().ToString(), "RcPay-2024");
```

**Первый параметр** - Сумма
Сумма в копейках. Например, сумма 3руб. 12коп. — это число 312;
Параметр должен быть равен сумме всех параметров Amount, переданных в объекте Items;
Минимальная сумма операции с помощью СБП составляет 10 руб.

**Второй параметр** - Идентификатор заказа в системе Мерчанта (Ваш магазин)
Идентификатор должен быть уникальным для каждой операции

**Третий параметр** - идентификатор покупателя
Идентификатор покупателя в системе Продавца. Если передается и Банком разрешена автоматическая привязка карт к
терминалу,
то для данного покупателя будет осуществлена привязка карты.

### 3. Проведение платежа

Подтверждает инициированный платеж передачей карточных данных.

```C#
/// 1 параметр. Уникальный идентификатор транзакции в системе Банка. (Полученный на прошлом этапе)
/// 2 параметр. Параметр, который определяет отравлять email с квитанцией или нет.
/// 3 параметр. Данные карты.
/// 4 параметр. Email на который будет отправлена квитанция об оплате.

var result = await _procedures.FinishAuthorize(paymentId, false, new DefaultCardData
{
    Pan = "0000000000000000", // Номер карты
    ExpiryDate = "1230",      // Срок действия в формате MMYY
    SecureCode = "111"        // CVV код
}, "support@recloud.tech");   // Email (2 параметр)
```