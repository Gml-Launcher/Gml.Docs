# Платежи по карте

На данной странице представлена подробная инструкция по проведению платежа по карте.
Следуйте всем шагам, чтобы успешно завершить процесс оплаты.

## Предварительные требования

> Перед тем как провести платеж, его нужно сформировать. Этот процесс обязателен для успешного проведения платежа.
> Подробности можно найти в [информации](tbank-payments-form.md#tbank-payment-init).

## Проведение платежа по карте

Подтверждает инициированный платеж передачей карточных данных.

```C#
/// 1 параметр. Уникальный идентификатор транзакции в системе Банка. (Полученный на прошлом этапе)
/// 2 параметр. Параметр, который определяет отравлять email с квитанцией или нет.
/// 3 параметр. Данные карты.
/// 4 параметр. Email на который будет отправлена квитанция об оплате.

var threeDsData = await acquiringSdk.FinishAuthorize(paymentId, false, new DefaultCardData
{
    Pan = "0000000000000000", // Номер карты
    ExpiryDate = "1230",      // Срок действия в формате MMYY
    SecureCode = "111"        // CVV код
}, "support@recloud.tech");   // Email (2 параметр)
```

Когда мы получаем объект типа `ThreeDsData`, он содержит информацию, необходимую для прохождения аутентификации 3D
Secure. Рассмотрим подробнее свойства этого объекта:

- `ACSUrl` (Access Control Server URL): Этот URL используется для перехода на страницу банка-эквайера для прохождения
  аутентификации.
- `MD` (Merchant Data): Данные продавца, которые необходимо передать на страницу аутентификации. Эти данные используются
  для распознавания транзакции.
- `PaReq` (Payment Authentication Request): Запрос на аутентификацию плательщика. Этот параметр используется для
  передачи данных о транзакции на страницу аутентификации.
- `IsThreeDsNeed`: Флаг, указывающий, требуется ли прохождение 3D Secure для этой транзакции. Если значение `true`, то
  необходимо пройти аутентификацию 3D Secure.

Работать с этим объектом можно следующим образом:

1. Проверить значение свойства `IsThreeDsNeed`. Если оно равно `true`, необходимо инициировать процесс аутентификации 3D
   Secure.
2. Использовать свойства `ACSUrl`, `MD` и `PaReq` для передачи данных на страницу аутентификации банка.

Пример:

```C#
// Проверяем, нужно ли проходить 3D Secure аутентификацию
if (threeDsData.IsThreeDsNeed)
{
    // Переход на страницу аутентификации с использованием полученных данных
    Redirect(threeDsData.ACSUrl, threeDsData.MD, threeDsData.PaReq);
}
```

Этот пример демонстрирует создание объекта `ThreeDsData` и использование его свойств для перехода на страницу
аутентификации. В случае, если аутентификация требуется, производится переход на URL, указанный в свойстве `ACSUrl`, с
передачей данных из свойств `MD` и `PaReq`.
